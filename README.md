This is an example of the views I developed to provide a comprehensive and integrated view of the information regarding arrivals from Honda. To anonymize internal terminology at Honda and its data, I have uploaded two of the queries I developed. The entire project also consisted of uploading the files to the SQL database after transforming them through Power Query.

The anonymized structure implicit in the queries follows the structure below. We had different types of documents containing information about motorcycle arrivals, which were issued to us progressively. Therefore, the first type of document DOC_1 was only valid if there was no additional information about the same motorcycles in the other types of documents. The second type of document DOC_2 took precedence over the first, but was disregarded once the same motorcycles appeared in the third DOC_3 and fourth DOC_4 types. Finally, all information about units in the fourth document made the remaining information in other documents obsolete.

In the queries, you can see that the least updated document is DOC_1 and the most updated document is DOC_4. The numbering indicates the order of validity of the documents in descending order.

You will also notice that these documents are reflected in the database tables, as all of them are drawn from DOC_X_ORIGINAL_SQL_TABLE in the queries. It is important to note that these tables store the different DOC_X in an accumulated manner. More specifically, they have the same columns as the original table, plus a final update date column indicating when the DOC_X was issued to us. This way, each DOC_X_ORIGINAL_SQL_TABLE retains all continuously issued versions of DOC_X, preserving as much information as needed. The queries take this into account and always extract only the information where the update date is the latest.

__Purpose of each query__

__arrivals_from_fabric_A.sql__ looks at all SQL tables containing the most updated versions of documents DOC_1, DOC_2, DOC_3, and DOC_4. For each motorcycle pending arrival, it retrieves the ETA (Estimated Time of Arrival) from the document with the highest number. In other words, preference is given to DOC_4; if there is no information for a unit there, then DOC_3; if not there, then DOC_2; and finally, if still missing, DOC_1.

__consistent_info_view_fabric_A.sql__ provides a complementary view on the documents. It checks whether there is consistency in units across the documents. The consistency logic is as follows: DOC_1 contains the historical record of units booked in a given month and serves as the reference to compare with all units appearing in subsequent DOC_2 and DOC_3. Specifically, motorcycles listed in DOC_1 that are pending arrival should also appear in DOC_2 (including those not yet shipped from fabric_A and some recently shipped). Some of these units will overlap with DOC_3, which contains the history of all units shipped to us and is updated as soon as units are shipped, even if they have not yet arrived.

In conclusion, all units of each month appearing in DOC_2 or DOC_3 must match those in DOC_1 for a given production (ORDER-MONTH). DOC_4 does not contain individual units, only container information.
